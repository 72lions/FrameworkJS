<!DOCTYPE HTML>
<html lang="en-US">
    <head>
        <meta charset="UTF-8">
        <title>Testing FrameworkJS</title>
    </head>
    <body>
        <script type="text/javascript" src="../src/json2.js"></script>
        <script type="text/javascript" src="../src/frameworkjs.js"></script>
        <script type="text/javascript" src="../src/publisher.js"></script>
        <script type="text/javascript" src="../src/ajax.js"></script>
        <script type="text/javascript" src="../src/service.js"></script>
        <script type="text/javascript" src="../src/utils.js"></script>
        <script type="text/javascript" src="../src/eventtarget.js"></script>
        <script type="text/javascript" src="../src/controller.js"></script>
        <script type="text/javascript" src="../src/view.js"></script>
        <script type="text/javascript" src="../src/model.js"></script>
        <script type="text/javascript">

            var arr = [1,2,3,4];
            var number = 1;
            var object = {a: 1};

            var  gridController1, gridView1, gridModel1, gridService1;
            var onTest, onTest2;
            var GridController, GridModel, GridView, GridService;

            //Create a new Controller.Grid controller
            GridController =  FrameworkJS.extend(function() {
                // Overwritting the properties
                this.name = 'GridController';
            }, FrameworkJS.Controller, 'Controller.Grid');

            //Create a new Controller.Grid controller
            GridModel =  FrameworkJS.extend(function() {
                // Overwritting the properties
                this.name = 'GridModel';
                this.data = {title: "MyTitle"};
            }, FrameworkJS.Model, 'Model.Grid');

            // Create a View.Grid view
            GridView = FrameworkJS.extend(function () {
                // Overwritting the properties
                this.name = 'GridView';
                this.domElement = '.test';

                /**
                 * Overwrite the draw function
                 */
                this.draw = function () {
                    //console.log('Overwritting the draw function...');
                };
            }, FrameworkJS.View, 'View.Grid');

            // Create a new Service.Grid service
            GridService = FrameworkJS.extend(function() {
                // Overwriting the onSuccess function
                this.onSuccess = function(result) {
                    console.log('Success dude!!!', result);
                }
            }, FrameworkJS.Service, 'Service.Grid');

            /**
             * Triggered when the onTest event is dispatched
             * @param  {Object} event The event
             */
            onTest = function(event){
                console.log('onTest', event);
            };

            /**
             * Triggered when the onTest event is dispatched
             * @param  {Object} event The event
             */
            onTest2 = function(event){
                console.log('onTest2', event);
            };

            // Creating the controllers, views, models and services
            gridView1 = FrameworkJS.retrieve('GRIDVIEW1', 'View.Grid', FrameworkJS.VIEW);
            gridModel1 = FrameworkJS.retrieve('GRIDMODEL1', 'Model.Grid', FrameworkJS.MODEL);
            gridController1 = FrameworkJS.retrieve('GRIDCONTROLLER1', 'Controller.Grid', FrameworkJS.CONTROLLER);
            gridService1 = FrameworkJS.retrieve('GRIDSERVICE1', 'Service.Grid', FrameworkJS.SERVICE);

            // Subscribing example
            gridController1.subscribe('onApplicationReady');
            FrameworkJS.Publisher.notify('onApplicationReady', {test: 'applicationReady'});
            gridController1.unsubscribe('onApplicationReady');
            FrameworkJS.Publisher.notify('onApplicationReady', {test: 'applicationReady'});

            // Setup the controller
            gridController1.name = 'GridController1';
            gridController1.setView(gridView1);
            gridController1.setModel(gridModel1);

            // Adding the event listeners
            gridController1.getView().addEventListener('onTest', onTest, gridController1);
            gridController1.getView().addEventListener('onTest', onTest2, gridController1);

            // Dispatching
            gridView1.dispatchEvent({type:'onTest'});

            // Remove the event listeners
            gridController1.getView().removeEventListener('onTest', onTest, this);
            gridController1.getView().removeEventListener('onTest', onTest2, this);

            // Call the service
            gridService1.url = 'data.json';
            gridService1.dataType = 'json';
            gridService1.fetch();

        </script>
    </body>
</html>